<!DOCTYPE HTML>
<!--
	Slate by Pixelarity
	pixelarity.com | hello@pixelarity.com
	License: pixelarity.com/license
-->
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Untitled</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" th:href="@{/assets/css/index.css}" />
	<noscript><link rel="stylesheet" th:href="@{/assets/css/noscript.css}" /></noscript>
</head>
<style>
	#side-wrap {
    width: 300px; /* 원하는 가로 크기로 조절 */
    margin: 0 auto; /* 수평 가운데 정렬 */
    padding: 20px; /* 내용과 사이드바 사이의 간격 설정 */
    border: 1px solid #ccc; /* 사각형 테두리 스타일 */
    border-radius: 10px; /* 사각형의 둥글기 설정 */
    }

    .side_info {
    text-align: center; /* 수평 가운데 정렬을 위한 설정 */
    }

    .prof_img {
    display: inline-block; /* 인라인 블록 요소로 설정 */
    }

    .rating {
    font-size: 18px; /* 등급 텍스트 크기 설정 */
    color: #333;    /* 등급 텍스트 색상 설정 */
    margin-top: 10px; /* 등급과 프로필 사진 사이의 위쪽 여백 설정 */
    }

    .user-id {
    font-size: 18px; /* 아이디 텍스트 크기 설정 */
    color: #333;    /* 아이디 텍스트 색상 설정 */
    margin-top: 10px; /* 아이디와 프로필 사진 사이의 위쪽 여백 설정 */
    }
    .goal-graph {
    width: 250px; /* 그래프 바의 전체 너비 */
    height: 20px; /* 그래프 바의 높이 (여유 공간을 위해 조정) */
    background-color: #f0f0f0; /* 그래프 바의 배경색 */
    border: 1px solid #ccc; /* 그래프 바 테두리 스타일 */
    border-radius: 20px; /* 그래프 바 테두리 둥글기 */
    margin: 20px; /* 페이지에서 그래프 바와의 간격 */
    display: felx;
    }

    /* Progress Bar (Filled Portion) */
    .progress-bar {
    width: 100%; /* 목표 달성 정도 (예: 100%) */
    height: 100%; /* 그래프 바와 같은 높이 */
    background-color: #4caf50; /* 목표 달성 부분의 배경색 */
    border-radius: 5px; /* 목표 달성 부분의 둥글기 */
    position: relative; /* 포지션 설정 */
    display: flex;
    }

    /* Progress Segment (날짜별 영역) */
    .progress-segment {
    height: 100%; /* 그래프 바와 같은 높이 */
    background-color: #4caf50; /* 각 날짜별 영역의 배경색 */
    border-radius: 5px; /* 각 날짜별 영역의 둥글기 */
    position: relative; /* 포지션 설정 */
    }

    /* Progress Label (Number) */
    .progress-label {
    position: absolute; /* 포지션 설정 */
    top: -20px; /* 그래프 바 위에서 조절 */
    left: 50%;
    transform: translateX(-50%);
    color: #000; /* 숫자 색상 */
    font-weight: bold; /* 굵게 표시 */
    }

    .point-container {
    display: flex;
    justify-content: space-between;
    }

    #tab-menu {
    display: flex; /* flex 레이아웃 사용 */
    flex-direction: row; /* 가로로 나열 */
    /* 다른 스타일을 추가할 수 있음 */
    justify-content: space-between; /* 간격을 조절하기 위해 */
    width: 300px; /* 전체 탭 메뉴 컨테이너의 너비를 조절 */
    margin: 0 auto; /* 중앙 정렬을 위해 */
    }

    #tab-menu div {
    padding: 10px; /* 각 탭 메뉴 아이템의 패딩 */
    cursor: pointer; /* 커서 모양을 포인터로 변경하여 클릭 가능하게 함 */
    /* 다른 스타일을 추가할 수 있음 */
    }

    #meal-options {
    display: flex; /* 자식 요소를 수평으로 배열하기 위해 Flexbox 레이아웃 사용 */
    justify-content: center; /* 자식 요소를 수평으로 가운데 정렬 */
    align-items: center; /* 자식 요소를 수직으로 가운데 정렬 */
    }

    #meal-options > div {
    margin: 0 10px; /* 각 요소 사이의 간격 조절 (원하는 크기로 조정) */
    }

    #meal-options div {
    cursor: pointer;
    }

    #tab-menu-container {
    display: flex; /* Flexbox 사용 */
    text-align: left;
    }

    #tan-dan-ji-box {
    display: flex; /* 내부의 tan-dan-ji-box도 Flexbox 사용 */
    flex-direction: column; /* 세로로 정렬 */
    }

    .today-tab .chall-tab .sub-tab .shop-tab{
    width: 70px; /* 각 탭 메뉴의 너비 */
    height: 70px; /* 각 탭 메뉴의 높이 (너비와 같게 설정하여 정사각형 모양으로 만듦) */
    background-color: #4caf50; /* 배경색을 설정 */
    text-align: center;
    line-height: 70px; /* 텍스트 세로 중앙 정렬을 위해 */
    color: #fff; /* 텍스트 색상 설정 */
    cursor: pointer; /* 마우스 커서를 포인터로 변경 */
    }

    #tan-dan-ji-box {
    display: flex; /* Flexbox를 사용하여 자식 요소를 가로로 정렬 */
    flex-direction: column; /* 자식 요소를 세로로 정렬 */
    /* background-color: lightgray; 사각형의 배경색 */
    border: 2px solid gray; /* 사각형 테두리 스타일 */
    padding: 10px; /* 내부 여백 설정 */
    width: 300px; /* 원하는 사각형 너비 설정 */
    text-align: left;
    }

    #tan-dan-ji-box > div {
    margin-bottom: 10px; /* 각 항목 아래 여백 설정 */
    }

    #another-page {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100px;
    }

    #another-page a {
    text-decoration: none;
    margin: 0 10px;
    }
</style>
<body class="is-preload">


<!-- Header -->
<th:block th:replace="~{layout/header::header(${session.loginUser},${session.user})}"></th:block>

<!-- Main -->
<section id="main" class="wrapper sidebar left">
	<div class="inner">

		<header class="major">
			<h2>마이페이지</h2>
			<p>북마크</p>
		</header>


		<!-- Content -->
		<div class="content">
			<div id="boardInfo" class="button cate now_cate" style="margin-right: 10px;">정보게시판</div>
			<div id="boardProduct" class="button cate not_cate" style="margin-right: 10px;">제품추천게시판</div>
			<!-- 게시글 리스트 띄우는 테이블 -->
			<table class="list">
				<thead id="data-table-head">

				</thead>
					<tr align="center" valign="middle">
						<th class="long_text">북마크번호</th>
						<th class="long_text">게시판번호</th>
						<th class="long_text">제목</th>
						<th class="long_text">작성자</th>
						<th class="long_text">날짜</th>
						<th class="long_text">조회수</th>
					</tr>
				<tbody id="data-table">

				</tbody>
			</table><!-- 페이징 처리하는 테이블 -->
			<table class="pagination">
				<tr align="center" valign="middle">
					<td>
						<a class="changePage" th:if="${pageMaker.prev}" th:href="${pageMaker.startPage-1}">&lt;</a>
						<th:block th:each="i : ${#numbers.sequence(pageMaker.startPage,pageMaker.endPage)}">
							<span class="nowPage" th:text="${i}" th:if="${pageMaker.cri.pagenum == i}"></span>
							<a class="changePage" th:href="${i}" th:text="${i}" th:unless="${pageMaker.cri.pagenum == i}"></a>
						</th:block>
						<a class="changePage" th:if="${pageMaker.next}" th:href="${pageMaker.endPage+1}">&gt;</a>
					</td>
				</tr>
			</table>
			<!-- 글쓰기 버튼 배치하는 테이블 -->
			<table>
				<tr align="right" valign="middle">
					<td>
						<a class="write" th:href="${'/board/write'+pageMaker.cri.listLink}">글쓰기</a>
					</td>
				</tr>
			</table>
			<form id="searchForm" th:action="@{/usermypage/user_subbookmark}">
				<div class="search_area">
					<label>
						<select name="type">
							<option value="" th:selected="${pageMaker.cri.type == null}">검색</option>
							<option value="T" th:selected="${pageMaker.cri.type == 'T'}">제목</option>
							<option value="C" th:selected="${pageMaker.cri.type == 'C'}">내용</option>
							<option value="W" th:selected="${pageMaker.cri.type == 'W'}">작성자</option>
							<option value="TC" th:selected="${pageMaker.cri.type == 'TC'}">제목 또는 내용</option>
							<option value="TW" th:selected="${pageMaker.cri.type == 'TW'}">제목 또는 작성자</option>
							<option value="TCW" th:selected="${pageMaker.cri.type == 'TCW'}">제목 또는 내용 또는 작성자</option>
						</select>
					</label>
					<label for="keyword"></label><input type="text" name="keyword" id="keyword" th:value="${pageMaker.cri.keyword}">
					<a href="#" class="button primary">검색</a>
				</div>
				<input type="hidden" value="1" name="pagenum">
				<input type="hidden" value="10" name="amount">
			</form>
		</div>

		<form name="pageForm" id="pageForm" th:action="@{/usermypage/user_subbookmark}">
			<input type="hidden" name="pagenum" th:value="${pageMaker.cri.pagenum}">
			<input type="hidden" name="amount" th:value="${pageMaker.cri.amount}">
			<input type="hidden" name="type" th:value="${pageMaker.cri.type}">
			<input type="hidden" name="keyword" th:value="${pageMaker.cri.keyword}">
		</form>

		<!-- Sidebar -->
		<th:block th:replace="~{layout/usermypage_sidebar::sidebar}"></th:block>

	</div>
</section>

<!-- Footer -->
<th:block th:replace="~{layout/footer::footer}"></th:block>

<!-- Scripts -->
<script th:src="@{/assets/js/jquery.min.js}"></script>
<script th:src="@{/assets/js/jquery.dropotron.min.js}"></script>
<script th:src="@{/assets/js/jquery.scrollex.min.js}"></script>
<script th:src="@{/assets/js/browser.min.js}"></script>
<script th:src="@{/assets/js/breakpoints.min.js}"></script>
<script th:src="@{/assets/js/util_sub.js}"></script>
<script th:src="@{/assets/js/main_sub.js}"></script>

<script th:src="@{/assets/js/sidebar.js}"></script>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:inline="javascript">
	const cate = document.querySelectorAll('.cate');
	let nowCate = document.querySelector('.now_cate');

	cate.forEach(function(btn) {
		btn.addEventListener('click', function() {
			if (btn.classList.contains('now_cate')) {
			 return;
			}

			btn.classList.remove('not_cate');
			btn.classList.add('now_cate');

			nowCate.classList.remove('now_cate');
			nowCate.classList.add('not_cate');

			nowCate = btn;
		});
	});

	$(document).ready(function() {
        let category = 'board_info';
        loadPage('/usermypage/board_info', 1);

        $('#boardInfo').click(function() {
            category = 'board_info';
            loadPage('/usermypage/board_info', 1);
        });

        $('#boardProduct').click(function() {
            category = 'board_product';
            loadPage('/usermypage/board_product', 1);
        });


        // 페이지 데이터를 불러오는 함수
        function loadPage(url, pageNum) {
            $.ajax({
                url: url,
                data: { pageNum: pageNum, category: category },
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    // 게시글 목록 업데이트
                    displayData(data);
                    // 페이징 버튼 업데이트
                    displayPaging(data.pageDTO);
                },
                error: function (error) {
                    console.error('데이터를 가져오는 중 오류 발생: ' + error);
                }
            });
        }




        function displayPaging(pageDTO) {
            var startPage = pageDTO.startPage;
            var endPage = pageDTO.endPage;
            var prev = pageDTO.prev;
            var next = pageDTO.next;

            var str = '';

            if (prev) {
                str += '<a class="changePage" href="' + (startPage - 1) + '"><code>&lt;</code></a>';
            }

            for (var i = startPage; i <= endPage; i++) {
                if (i === pageDTO.cri.pagenum) {
                    str += '<span class="nowPage">' + i + '</span> ';
                } else {
                    str += '<a class="changePage" href="' + i + '">' + i + '</a>';
                }
            }

            if (next) {
                str += '<a class="changePage" href="' + (endPage + 1) + '"><code>&gt;</code></a>';
            }

            var page = $('.pagination');
            page.html('<tr align="center" valign="middle"><td>' + str + '</td></tr>');

            // 페이지 버튼 클릭 이벤트를 연결
            $(".changePage").on("click", function (e) {
                e.preventDefault(); // 기본 동작 중지

                var pageNum = $(this).attr('href');
                loadPage('/usermypage/' + category, pageNum);
            });
        }


		function displayData(data) {
			var tableHead = $('#data-table-head');
			tableHead.empty();
			var tableBody = $('#data-table');
			tableBody.empty();


			var headRow = $('<tr align="right" valign="middle">');
			headRow.append('<td colspan="6">글 개수 : '+data.pageDTO.total+'</td>');
			tableHead.append(headRow);

			if (data.list != null && data.list.length > 0) {
				data.list.forEach(function (board) {
					var row = $('<tr>');
					row.append('<td class="long_text">x</td>');
					row.append('<td class="long_text">' + board.boardNum + '</td>');
					row.append('<td class="long_text">' + board.boardTitle+ '</td>');
					row.append('<td class="long_text"><a href="#" class="open">' + board.userId + '</td>');
					row.append('<td class="long_text">' + board.regdate + '</td>');
					row.append('<td class="long_text">' + board.viewCnt + '</td>');
					tableBody.append(row);
				});
			}
			else {
				tableBody.append('<tr><td colspan="6">등록된 게시글이 없습니다.</td></tr>');
			}
            $(".open").on("click", function (e) {
                e.preventDefault();
				var userId = $(this).text();

				sendUserIdToModal(userId);
                modalBox.classList.add("active");
            });
		}
	});
</script>
</body>
</html>