<!DOCTYPE HTML>
<!--
	Slate by Pixelarity
	pixelarity.com | hello@pixelarity.com
	License: pixelarity.com/license
-->
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<title>Fit Hub</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<noscript><link rel="stylesheet" th:href="@{/assets/css/noscript.css}" /></noscript>
	<link rel="stylesheet" th:href="@{/assets/css/index.css}" />
	<link rel="stylesheet" th:href="@{/assets/css/sidebar.css}" />
	<link rel="stylesheet" th:href="@{/assets/css/common.css}" />

</head>
<style>

	.uInputArea {
    display: table;
    width: 100%;
    height: 30px;
    padding: 10px 0;
    border-bottom: 1px solid black;
	}
	.uInputArea .uInput label {
    font-size: 15px;
    line-height: 30px;
    color: black;
    float: left;
    font-weight: bold;
	}
	.uInputArea .uInput .inputBox {
    overflow: hidden;
    position: relative;
	}
	.uInputArea .uInput:after {
    content: "";
    display: block;
    clear: both;
	}

	.uInputArea .col:last-child {
    padding-right: 5px;
	}
	.uInputArea .col:first-child {
		width: 100%;
		padding-left: 5px;
	}
	.uInputArea .col {
		display: table-cell;
		vertical-align: top;
	}
	.uInputArea .uInput .inputBox .inputText {
    font-size: 15px;
    line-height: 30px;
    color: black;
    display: block;
    width: 100%;
    height: 30px;
    padding: 0 25px 0 10px;
    box-sizing: border-box;
    border: 0;
    outline: 0;
    background: none;
	}
		.uInputArea .col:last-child {
		padding-right: 5px;
	}

	.uInputArea .col {
		display: table-cell;
		vertical-align: top;
	}
	.uInputArea .uInput .inputBox .btnDel {
    display: none;
    position: absolute;
    bottom: 0;
    right: 0;
    width: 25px;
    height: 30px;
	}
	.uErrorText {
    font-size: 13px;
    line-height: 20px;
    color: #dc941b;
    margin-top: 5px;
    padding: 0 5px;
	}
	.uInputArea .uBtnArea {
    white-space: nowrap;
    font-size: 0;
	}
	.uInputArea .uBtnArea .uBtn {
    display: inline-block;
    width: auto;
    font-size: 13px;
    height: 30px;
    margin-left: 5px;
    color: #666 !important;;
    border: 0;
    box-shadow: inset 0 0 0 0;
	}

	img.thumbnail{
		display:block;
		clear:both;
		width:100px;
	}

	.btn_box{
		float: right;
		margin-right: 10px;
	}

	table tr {
		font-weight: bold;
	}

	.file_text{
		display: block;
 		height: 40px;
    	line-height: 3;
	}

	table tr th{
		vertical-align: top;
		padding-top: 21px;
	}
</style>
<body class="is-preload">


<!-- Header -->
<th:block th:replace="~{layout/header::header(${session.loginUser},${session.user},${session.trainer},${session.admin})}"></th:block>

<!-- Main -->
<section id="main" class="wrapper sidebar left">

	<div class="header_box">
		<header class="test12">
			<p id="mainText">마이페이지</p>
			<p id="subText">트레이너 전환 신청</p>
		</header>
	</div>

	<div class="inner">

		<!-- Content -->
		<div class="content">

			<form id="boardForm" name="boardForm" method="post" th:action="@{/usermypage/applytrainer}" enctype="multipart/form-data">
				<table style="text-align: center; margin: 0px" class="none_color_table">
					<tr>
						<td>아이디</td>
						<td><input name="userId" type="text" id="inputId" class="inputText" placeholder="6~20자 영문, 숫자" tabindex="1" th:value="${user.userId}" readonly></td>
					</tr>
					<tr>
						<td>우편번호</td>
						<td style="display: flex;">
							<input style="width:79%; margin-right: 10px;" readonly name="trainerZipcode" type="text" id="sample6_postcode" placeholder="우편번호" onclick="sample6_execDaumPostcode()">
							<div style="width:20%;" onclick="sample6_execDaumPostcode()" class="button btnColor">우편번호 찾기</div>
						</td>
					</tr>
					<tr>
						<td>주소</td>
						<td><input readonly name="trainerAddr" type="text" id="sample6_address" placeholder="주소"></td>
					</tr>
					<tr>
						<td>상세주소</td>
						<td><input name="trainerAddrdetail" type="text" id="sample6_detailAddress" placeholder="상세주소"></td>
					</tr>
					<tr>
						<td>참고항목</td>
						<td><input readonly name="trainerAddretc" type="text" id="sample6_extraAddress" placeholder="참고항목"></td>
					</tr>
					<tr>
						<td>파트</td>
						<td><input name="trainerPart" type="text" id="inputgender" class="inputText" placeholder="파트" tabindex="6" value="" ></td>
					</tr>
					<tr>
						<td>경력</td>
						<td><input name="trainerCareer" type="text" id="inputBirth" class="inputText" placeholder="경력" tabindex="7" value="" ></td>
					</tr>
					<tr>
						<td>내용</td>
						<td><input name="trainerContent" type="text" id="inputcontents" class="inputText" placeholder="내용" tabindex="8" value="" ></td>
					</tr>

					<tr class="r0 at">
						<th>파일 첨부1</th>
						<td class="file0_cont">
							<div style="float:left;">
								<input type="file" name="files" id="file0" style="display:none">
								<span id="file0name" class="file_text">선택된 파일 없음</span>
							</div>
							<div style="float:right;">
								<a href="javascript:upload('file0')" class="button btnColor">파일 선택</a>
								<a href="javascript:cancelFile('file0')" class="button btnColor">첨부 삭제</a>
							</div>
						</td>
					</tr>
				</table>
				<hr>
				<div class="btn_box">
					<div class="submit button btnColor" onclick="sendit();">신청 완료</div>
				</div>
			</form>
		</div>


		<!-- Sidebar -->
		<div class="sidebar">
			<section>
				<div class="boardRanking">
					<div class="boardRanking_ranking">
						<table style="width: 90%;">
							<tr><td><a href="/usermypage/user_myinfo">내 정보 수정</a></td></tr>
<!--							<tr><td><a href="/usermypage/user_diary">나의 다이어리</a></td></tr>-->
							<tr><td><a href="/usermypage/user_challenge">나의 챌린지</a></td></tr>
							<tr><td><a href="/usermypage/user_subtrainer">구독한 트레이너</a></td></tr>
							<tr><td><a href="/usermypage/user_subbookmark">북마크</a></td></tr>
							<tr><td><a href="/usermypage/user_boardlist">내 게시물</a></td></tr>
							<tr><td><a href="/usermypage/user_messagelist">쪽지함</a></td></tr>
							<tr><td><a href="/usermypage/user_myprofile">나의 프로필</a></td></tr>
							<tr><td><a href="/usermypage/user_applytrainer" style="color: #5a8100; font-size: 20px;">트레이너 전환 신청</a></td></tr>
						</table>
					</div>
				</div>
			</section>
		</div>

	</div>
</section>

<!-- Footer -->
<th:block th:replace="~{layout/footer::footer}"></th:block>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:src="@{/assets/js/jquery.dropotron.min.js}"></script>
<script th:src="@{/assets/js/jquery.scrollex.min.js}"></script>
<script th:src="@{/assets/js/browser.min.js}"></script>
<script th:src="@{/assets/js/breakpoints.min.js}"></script>
<script th:src="@{/assets/js/util_sub.js}"></script>
<script th:src="@{/assets/js/main_sub.js}"></script>

<script th:src="@{/assets/js/sidebar.js}"></script>



<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
	function sample6_execDaumPostcode() {
        new daum.Postcode({
            oncomplete: function(data) {
                // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                // 각 주소의 노출 규칙에 따라 주소를 조합한다.
                // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                var addr = ''; // 주소 변수
                var extraAddr = ''; // 참고항목 변수

                //사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                    addr = data.roadAddress;
                } else { // 사용자가 지번 주소를 선택했을 경우(J)
                    addr = data.jibunAddress;
                }

                // 사용자가 선택한 주소가 도로명 타입일때 참고항목을 조합한다.
                if(data.userSelectedType === 'R'){
                    // 법정동명이 있을 경우 추가한다. (법정리는 제외)
                    // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                    if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                        extraAddr += data.bname;
                    }
                    // 건물명이 있고, 공동주택일 경우 추가한다.
                    if(data.buildingName !== '' && data.apartment === 'Y'){
                        extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }
                    // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                    if(extraAddr !== ''){
                        extraAddr = ' (' + extraAddr + ')';
                    }
                    // 조합된 참고항목을 해당 필드에 넣는다.
                    document.getElementById("sample6_extraAddress").value = extraAddr;

                } else {
                    document.getElementById("sample6_extraAddress").value = '';
                }

                // 우편번호와 주소 정보를 해당 필드에 넣는다.
                document.getElementById('sample6_postcode').value = data.zonecode;
                document.getElementById("sample6_address").value = addr;
                // 커서를 상세주소 필드로 이동한다.
                document.getElementById("sample6_detailAddress").focus();
            }
        }).open();
    }



	let i = 0;
	function upload(name){
		$("#"+name).click();
	}
	//$(선택자).change(함수) : 해당 선택자의 요소에 변화가 일어난다면 넘겨주는 함수 호출
	$("[type='file']").change(function(e){
		//e : 파일이 업로드된 상황 자체를 담고있는 객체
		//e.target : 파일이 업로드가 된 input[type=file] 객체(태그객체)
		//e.target.files : 파일태그에 업로드를 한 파일 객체들의 배열
		const file = e.target.files[0];
		const fileTag = e.target;

		if(file == undefined){
			//파일이 업로드 되었다가 없어진 경우
			cancelFile(fileTag.id);
		}
		else{
			//파일이 없었다가 업로드 한 경우
			//#file0name
			$("#"+fileTag.id+"name").text(file.name);
			//업로드 된 파일의 확장자명
			let ext = file.name.split(".").pop();
			if(ext == 'jpeg' || ext == 'jpg' || ext == 'png' || ext == 'gif' || ext == 'webp'){
				$("."+fileTag.id+"_cont .thumbnail").remove();
				const reader = new FileReader();

				reader.onload = function(ie){
					const img = document.createElement("img");
					img.setAttribute("src",ie.target.result)
					img.setAttribute("class","thumbnail");
					document.querySelector("."+fileTag.id+"_cont").appendChild(img);
				}
				reader.readAsDataURL(file);
			}
			else{
				const temp = $("."+fileTag.id+"_cont .thumbnail");
				if(temp != null){
					temp.remove();
				}
			}
			//가장 마지막 파일 선택 버튼을 눌렀을 때
			if(fileTag.id.split("e")[1] == i){
				const cloneElement = $(".r"+i).clone(true);
				i++;
				cloneElement.appendTo("#boardForm tbody")
				const lastElement = $("#boardForm tbody").children().last();

				lastElement.attr("class","r"+i+" at");
				lastElement.children("th").text("파일 첨부"+(i+1));
				lastElement.children("td").attr("class","file"+i+"_cont");

				lastElement.find("input[type='file']").attr("name","files");
				lastElement.find("input[type='file']").attr("id","file"+i);
				lastElement.find("input[type='file']").val("");

				lastElement.find("span").attr("id","file"+i+"name");
				lastElement.find("span").text("선택된 파일 없음");

				lastElement.find("a")[0].href = "javascript:upload('file"+i+"')";
				lastElement.find("a")[1].href = "javascript:cancelFile('file"+i+"')"
			}

		}
	})

	function cancelFile(name){
		//가장 마지막 첨부 삭제 버튼을 누른 경우
		if(name.split("e")[1] == i){ return; }
		//현재 업로드된 파일이 여러개일 때
		if(i != 0){
			//tr지우기
			let temp = Number(name.split("e")[1]);
			//해당 행 지우기
			$(".r"+temp).remove();
			//지워진 다음 행 부터 숫자 바꿔주기
			for(let j=temp+1;j<=i;j++){
				const el = $("#boardForm tbody").find(".r"+j);
				el.attr("class","r"+(j-1)+" at");

				el.children('th').text("파일 첨부"+j);

				el.children('td').attr("class","file"+(j-1)+"_cont");

				const fileTag = el.find("input[type='file']");
				fileTag.attr("name","file"+(j-1));
				fileTag.attr("id","file"+(j-1));

				el.find("span").attr("id","file"+(j-1)+"name");

				el.find("a")[0].href = "javascript:upload('file"+(j-1)+"')"
				el.find("a")[1].href = "javascript:cancelFile('file"+(j-1)+"')"

			}
			i--;
		}
	}




	function sendit(){
		const boardForm = document.boardForm;

		const trainerAddr = boardForm.trainerAddr;
		if(trainerAddr.value == ""){
			alert("주소을 입력하세요!");
			trainerAddr.focus();
			return false;
		}

		const trainerPart = boardForm.trainerPart;
		if(trainerPart.value == ""){
			alert("파트를 입력하세요!");
			trainerPart.focus();
			return false;
		}

		const trainerCareer = boardForm.trainerCareer;
		if(trainerCareer.value == ""){
			alert("경력를 입력하세요!");
			trainerCareer.focus();
			return false;
		}

		const trainerContent = boardForm.trainerContent;
		if(trainerContent.value == ""){
			alert("내용를 입력하세요!");
			trainerContent.focus();
			return false;
		}

		boardForm.submit();
	}

</script>
</body>
</html>