<!DOCTYPE HTML>
<!--
	Slate by Pixelarity
	pixelarity.com | hello@pixelarity.com
	License: pixelarity.com/license
-->
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Fit Hub</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <link rel="stylesheet" th:href="@{/assets/css/index.css}"/>
    <link rel="stylesheet" th:href="@{/assets/css/sidebar.css}"/>
    <noscript>
        <link rel="stylesheet" th:href="@{/assets/css/noscript.css}"/>
    </noscript>
    <link rel="stylesheet" th:href="@{/assets/css/common.css}"/>

    <!-- Modal -->
    <link rel="stylesheet" th:href="@{/assets/css/matchingModal.css}"/>
    <link rel="stylesheet" th:href="@{/assets/css/profileModal.css}"/>
    <link rel="stylesheet" th:href="@{/assets/css/reportModal.css}"/>

</head>
<style>
    .header_box {
        width: 100%;
        background: linear-gradient(to right, rgba(143, 167, 70, 0.25), rgba(143, 167, 70, 0.3)), url(/images/test3.png);
        background-size: cover;
        background-position: 0 65%;
    }
    .wrapper.sidebar > .inner > .content{
        width: 70%;
    }
    #side_box{
        width: 30%;
    }

    #side_box table tbody tr:nth-child(2n + 1) {
        background-color: #FFFFFF;
    }

    .top_img_box {
        width: 100%;
        height: 310px;
        margin-bottom: 50px;
        background-color: red;
    }

    .top_img_box > img {
        width: 100%;
        height: 100%;
    }

    #main {
        padding: 0;
    }

    .wrapper {
        padding: 0;
        margin-bottom: 100px;
    }

    #header {
    <!-- background-color: #5a8100;
    -->
    }

    #header nav > ul > li a {
        color: white;
    }

    #header h1 a {
        color: white;
    }

    #header .main ul li > a {
        color: white;

    }

    #footer {
        background-color: #304400;
    }


    .write_table {
        border: none;
    }

    .write_table tr {
        border-top: none;
        border-bottom: 1px solid gray;
        background-color: white !important;
        height: 50px;
    }



    .cotent_header {
        font-size: 30px;
        font-weight: bold;
        margin-bottom: 20px;
    }

    #profileInfo {
        width: 350px;
        vertical-align: top;
    }

    #profileInfo img {
        max-width: 100%;
        height: auto;
        display: block; /* 이미지 사이에 생기는 여백을 제거하기 위해 추가 */
        margin: auto; /* 이미지를 가운데 정렬하기 위해 추가 */
    }

    #careerInfo img {
        margin: auto;
    }


    #content_title th {
        padding-top: 20px;
    }

    .careerPic th {
        background-color: white !important;
        border-top: none;
        border-bottom: 1px solid black;
        margin-bottom: 15px;
    }

    .careerPic tr {
        border-top: none;

    }

    .button_table {

        background-color: white !important;
    }

    .button_table tr {
        border: none;
        background-color: white !important;
        height: 80px;
    }


    .button_table tr td a:hover {
        /*background-color: #ebede1 !important;*/
        transition: transform 0.4s;
        font-weight: bold;
    }

    #review_userid {
        border: none;
        font-weight: bold;
    }

    #review_textarea {
        margin-top: 20px;
    }

    .review_result a {
        border-radius: 15px;
    }

    .review_result h4:after {
        border-bottom: none;
    }

    #finish_button {
        margin-top: 40px;
    }

    .open:hover {
        color: #5a8100;
        font-weight: bold;
    }

    .starpoint{
    display: flex;
    }
    .starpoint div{
    margin-left: 20px;
    }
    #result{
    margin-bottom:50px;
    }
.reviews{
margin-top: 30px;
}
.displayNoneDiv{
display: none;
}




    <!--
    star rating

    -->
    .rating {
        unicode-bidi: bidi-override;
        direction: rtl;
        text-align: center;
    }

    .star {
        display: inline-block;
        margin: 0 5px;
        font-size: 24px;
        cursor: pointer;
        color: #ccc;
    }

    .star.active,
    .star:hover {
        color: #ffcc00;
    }





    a.btnColor{
        background: #FFFFFF;
        border: 1px solid #5a8100;
        border-radius: 4px;
        color: #5a8100 !important;
        box-shadow: 4px 4px 2px 0px rgb(203,211,177);

    }
    a.btnColor:hover{
        background: #5a8100;
        border: 1px solid #5a8100;
        border-radius: 4px;
        color: #F7FAF5 !important;
        box-shadow: 0 0 2px #5a8100;

    }
    #side_box .rankBox input[type=button].rankBtn {
        border-radius: 38px !important;
        border: 1px solid;
        box-shadow: 4px 4px 2px 0px #5a8100 !important;
    }

    #side_box .rankBox input[type=button].rankBtn:hover {
        color: #444 !important;
        background-color: #ebede1; !important;
    }
    #side_box .open:hover {
        color: #5a8100;
        font-weight: bold;
        cursor: pointer;
    }
    .rankBox:first-child td a{
        cursor: default !important;
    }


</style>

<!-- Header -->
<th:block
        th:replace="~{layout/header::header(${session.loginUser},${session.user},${session.trainer},${session.admin},${session.profile},${session.todaydate})}"></th:block>

<!-- Modal -->
<th:block th:replace="~{layout/matchingModal::matchingModal()}"></th:block>
<th:block th:replace="~{layout/profileModal::profileModal}"></th:block>
<th:block th:replace="~{layout/reportModal::reportModal()}"></th:block>

<!-- Main -->
<section id="main" class="wrapper sidebar left">

    <div class="header_box">
        <header class="test12">
            <p id="mainText">트레이너 매칭</p>
            <p id="subText">매칭 글 페이지</p>
        </header>
    </div>

    <div class="inner">

        <!-- Content -->
        <div class="content">
            <th:block th:if="${list != null}" th:each="board : ${list}">
                <div class="cotent_header open" style="display: flex; justify-content: flex-start; cursor: pointer;">
                    <div id="profileInfo">
                        <th:block th:if="${profileInfo != null}">
                            <div style="display:flex; justify-content:center;">
                                <img style="width:200px; height:200px; border-radius: 100%;"
                                     th:src="@{/matching/thumbnail (sysName=${profileInfo.sysName})}">
                            </div>
                        </th:block>
                    </div>
                    <div class="open" style="line-height: 9; font-size:22px;">[[${trainerInfo.trainerNickname}]]님의 글입니다</div>
                    <div style="font-size:15px; line-height: 13.3; margin-left: 20px;">별점 : <span>[[${starRatingAv}]]</span></div>
                </div>
                <form>
                    <!-- 글작성 테이블 -->
                    <div>
                        <table class="write_table" style="text-align: center;">
                            <tr>
                                <td style="width: 20%; font-weight: bold;" colspan="1">제목</td>
                                <td colspan="2">
                                    <input type="text" name="boardTitle" style="width:100%;" size="50" maxlength="50" th:value="${board.boardTitle}" readonly>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="1" style="font-weight: bold;">만료일시</td>
                                <td colspan="2">
                                    <input type="text" name="expirationTime" style="width:100%;" size="50" maxlength="50" th:value="${board.expirationTime}" readonly>
                                    <a style="display: none;" id="matchingTrainerId">[[${trainerInfo.trainerId}]]</a>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold;">상담가능시간</td>
                                <td>
                                    <input type="text" name="availConsultWeeks" style="width:100%;" size="50" maxlength="50" th:value="${board.availConsultWeeks}" readonly>
                                </td>
                                <td>
                                    <input type="text" name="availConsultTime" style="width:100%;" size="50" maxlength="50" th:value="${board.availConsultTime}" readonly>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold;">파트 / 경력</td>
                                <td>
                                    <input type="text" name="trainerPart" style="width:100%;" size="50" maxlength="50" th:value="${trainerInfo.trainerPart}" readonly>
                                </td>
                                <td>
                                    <input type="text" name="trainerCareer" style="width:100%;" size="50" maxlength="50" th:value="${trainerInfo.trainerCareer}" readonly>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold;" colspan="1">트레이너 소개</td>
                                <td colspan="2">
                                    <input type="text" name="trainerIntro" style="width:100%;" size="50" maxlength="50" th:value="${trainerInfo.trainerIntro}" readonly>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold;" colspan="1">트레이너의 위치</td>
                                <td colspan="2">
                                    <input type="text" name="trainerAddr" style="width:100%;" size="50" maxlength="50" th:value="${board.trainerAddr}" readonly>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3">
                                    <div id="map" style="width:100%;height:350px;"></div>
                                    <script type="text/javascript"
                                            src="//dapi.kakao.com/v2/maps/sdk.js?appkey=9d457fe0b04b983671f48d03d84f2fdb&libraries=services"></script>
                                    <script>
                                        var mapContainer = document.getElementById('map'), // 지도를 표시할 div
                                            mapOption = {
                                                center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
                                                level: 3 // 지도의 확대 레벨
                                            };

                                        // 지도를 생성합니다
                                        var map = new kakao.maps.Map(mapContainer, mapOption);

                                        // 주소-좌표 변환 객체를 생성합니다
                                        var geocoder = new kakao.maps.services.Geocoder();

                                        var address = '[[${board.trainerAddr}]]';


                                        // 주소로 좌표를 검색합니다
                                        geocoder.addressSearch(address, function (result, status) {

                                            // 정상적으로 검색이 완료됐으면
                                            if (status === kakao.maps.services.Status.OK) {

                                                var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                                                // 결과값으로 받은 위치를 마커로 표시합니다
                                                var marker = new kakao.maps.Marker({
                                                    map: map,
                                                    position: coords
                                                });

                                                // 인포윈도우로 장소에 대한 설명을 표시합니다
                                                var infowindow = new kakao.maps.InfoWindow({
                                                    content: '<div style="width:150px;text-align:center;padding:6px 0;">[[${trainerInfo.trainerNickname}]]</div>'
                                                });
                                                infowindow.open(map, marker);

                                                // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
                                                map.setCenter(coords);
                                            }
                                        });
                                    </script>
                                </td>
                            </tr>
                            <tr>
                                <td style="font-weight: bold;" colspan="3">내용</td>
                            </tr>
                            <tr id="content_tr">
                                <td colspan="3">
                                    <input type="text" name="boardContent" style="width:100%;" size="50" maxlength="50" th:value="${board.boardContent}" readonly>
                                </td>
                            </tr>
                        </table>
                        <table class="careerPic">
                            <tr>
                                <td style="font-weight: bold;">경력 및 자격 사진</td>
                            </tr>
                        </table>
                        <div>
                            <div id="careerInfo">
                                <th:block th:if="${careerInfo != null}" th:each="career : ${careerInfo}">
                                    <img style="width: 200px;" th:src="@{/matching/thumbnail (sysName=${career.sysName})}">
                                </th:block>
                            </div>
                        </div>
                    </div>
                </form>

                <!-- 등록, 목록 버튼 테이블 -->
                <table class="button_table">
                    <tr>

                        <td>
                            <a href="#" class="matchingOpen btnColor button" style="margin-left:15px;" data-trainer-id="${trainerInfo.trainerId}">신청하기</a>
                            <a href="#" class="heart" style="float:left; margin-right:5px;"><img id="heart" th:src="'/images/like_'+${heart!=null?'on':'off'}+'.png'" style="width:30px;"></a>
                            <a th:class="${bookmark != null ? 'bookmarked' : ''}+' bookmark button btnColor small'" style="float:left; margin-left:10px;">북마크</a>
                            <div class="displayNoneDiv writer">[[${board.trainerId}]]</div>
                            <div class="displayNoneDiv boardNum">[[${board.boardNum}]]</div>
                            <div class="displayNoneDiv boardCategory">matching</div>
                            <a href="#"  class="reportOpen btnColor button">신고</a>
                        </td>
                        <td colspan="2">
                            <div style="display: flex; justify-content: flex-end;">
                                <th:block th:if="${board.trainerId == session.loginUser}">
                                    <form name="BoardPageForm" method="post" th:action="@{/matching/remove}">
                                        <input name="boardNum" th:value="${board.boardNum}" type="hidden">
                                        <input name="pagenum" th:value="${cri.pagenum}" type="hidden">
                                        <input name="amount" th:value="${cri.amount}" type="hidden">
                                        <input name="type" th:value="${cri.type}" type="hidden">
                                        <input name="keyword" th:value="${cri.keyword}" type="hidden">
                                        <a class="btnColor button" href="javascript:modify()">수정</a>
                                        <a class="btnColor button" href="javascript:document.BoardPageForm.submit()">삭제</a>
                                    </form>
                                </th:block>
                                <a style="margin-left: 5px;" class="btnColor button" th:href="${'/matching/matching_list'+cri.listLink}">목록</a>
                            </div>
                        </td>
                    </tr>
                </table>
                <!-- review -->
                <div class="review_line">
                    <a href="#" class="regist btnColor button" style="font-weight:bold; font-size:20px">리뷰 작성</a>
                    <div class="reviewForm row">
                        <div style="width:20%">
                            <h4 id="review_btn">리뷰 작성</h4>
                            <input type="text" name="userId" th:value="${session.loginUser}" readonly style="text-align: center;">
                            <input name="boardNum_1" id="boardNum2" th:value="${board.boardNum}" type="hidden">
                        </div>
                        <div style="width:65%">
                            <div class="starpoint">
                                <h4>별점</h4>
                                <div class="rating" data-star-rating="0">
                                    <span class="star" data-rating="1">&#9733;</span>
                                    <span class="star" data-rating="2">&#9733;</span>
                                    <span class="star" data-rating="3">&#9733;</span>
                                    <span class="star" data-rating="4">&#9733;</span>
                                    <span class="star" data-rating="5">&#9733;</span>
                                </div>
                            </div>
                            <textarea name="reviewContent" placeholder="리뷰를 작성해주세요" style="resize:none;width:450px;"></textarea>
                        </div>
                        <div style="width:15%">
                            <a href="#" class="button finish btnColor small" style="margin-bottom:1rem; margin-top: 100px;">등록</a>
                            <a href="#" class="button cancel btnColor small">취소</a>
                        </div>
                    </div>
                    <ul class="reviews"></ul>
                    <div class="page"></div>
                </div>
            </th:block>
        </div>

        <th:block th:replace="~{layout/rank_sidebar::sidebar}"></th:block>
    </div>


</section>

<!-- Footer -->
<th:block th:replace="~{layout/footer::footer}"></th:block>

<!-- Scripts -->
<script th:src="@{/assets/js/jquery.min.js}"></script>
<script th:src="@{/assets/js/jquery.dropotron.min.js}"></script>
<script th:src="@{/assets/js/jquery.scrollex.min.js}"></script>
<script th:src="@{/assets/js/browser.min.js}"></script>
<script th:src="@{/assets/js/breakpoints.min.js}"></script>
<script th:src="@{/assets/js/util.js}"></script>
<script th:src="@{/assets/js/main.js}"></script>

<script th:src="@{/assets/js/util_sub.js}"></script>
<script th:src="@{/assets/js/main_sub.js}"></script>

<script th:src="@{/assets/js/sidebarTap.js}"></script>

<script th:src="@{/assets/js/profile.js}"></script>
<script th:src="@{/assets/js/reply.js}"></script>

<script th:src="@{/assets/js/matching_u_t_matching.js}"></script>
<script th:src="@{/assets/js/reportModal.js}"></script>

<script th:src="@{/assets/js/review.js}"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script th:inline="javascript">
    const loginUser = /*[[${session.loginUser}]]*/'';
	let boardNum = $("[name='boardNum_1']").val();
	const reviews = $(".reviews")
	const reviewBtn = $(".review_btn")
	const page = $(".page")
	let nowpage = 0;


$(document).ready(function() {
    nowpage = 1;
    showList(1)
    var trainerId = [[${trainerInfo.trainerId}]];

    $.ajax({
        url: '/matching/check?trainerId='+trainerId,
        type: 'GET',
        success: function(data) {
            if (data) {
                // 데이터가 있을 때
                $(".regist").show();
                $(".reviewForm").hide();
            }
            else {
                // 데이터가 없을 때
                $(".regist").hide();
                $(".reviewForm").hide();
            }
        },
        error: function(error) {
            console.error('Error fetching data:', error);
        }
    });



     // 댓글 등록 링크 클릭 시
    $(".regist").click(function(e) {
        e.preventDefault();
        $.ajax({
            url: '/matching/checkReview?boardNum='+boardNum,
            type: 'GET',
            success: function(data) {
            console.log(data);
                if (data) {
                    // 데이터가 있을 때
                   alert("작성한 리뷰가 있습니다. 확인 후 다시 시도해주세요!");
                    showList(1);
                }
                else {
                    $(".reviewForm").show();
                    $(".regist").hide();
                }
            },
            error: function(error) {
                console.error('Error fetching data:', error);
            }
        });
    });



    $(".finish").on("click", function(e) {
        e.preventDefault();
        let reviewContent = $("[name='reviewContent']").val();
        let starRating = $(".rating").attr("data-star-rating");
        let boardNum = $("[name='boardNum_1']").val();

        // 리뷰 내용과 별점이 작성되지 않았을 때 알림 표시
        if (!reviewContent || !starRating) {
            alert("리뷰 내용과 별점을 작성해주세요!");
            return; // 이후 코드 실행 중단
        }

        reviewService.add(
            {
                "boardNum": boardNum,
                "userId": loginUser,
                "reviewContent": reviewContent,
                "starRating": starRating
            },
            function(result) {
                alert("등록!");
                showList(1);
                $(".regist").show();
                $(".reviewForm").hide();
                $("[name='reviewContent']").val("");
                $("[class='rating']").val("");
            }
        );
    });

	function showReviewPage(reviewCnt, pagenum){
		let endPage = Math.ceil(pagenum/5)*5;
		let startPage = endPage - 4;

		let prev = startPage != 1;
		endPage = (endPage-1)*5 >= reviewCnt ? Math.ceil(reviewCnt/5) : endPage;
		let next = endPage*5 < reviewCnt ? true : false;

		let str = "";
		if(prev){
			//<a class="changePage" href="5"><code>&lt;</code></a>
			str += '<a class="changePage" href="'+(startPage-1)+'"><code>&lt;</code></a>';
		}
		for(let i=startPage;i<=endPage;i++){
			if(i == pagenum){
				//<code class="nowPage">7</code>
				str += '<code class="nowPage">'+i+'</code>';
			}
			else{
				//<a class="changePage" href="9"><code>9</code></a>
				str += '<a class="changePage" href="'+i+'"><code>'+i+'</code></a>';
			}
		}
		if(next){
			str += '<a class="changePage" href="'+(endPage+1)+'"><code>&gt;</code></a>';
		}

		page.html(str);

		$(".changePage").on("click",function(e){
			e.preventDefault();
			let target = $(this).attr("href");
			nowpage = parseInt(target);
			showList(nowpage);
			window.setTimeout(function(){
				window.scrollTo(0,document.body.scrollHeight)
			},10)
		})
	}



    function showList(pagenum){
		reviewService.getList(
			{boardNum:boardNum, pagenum:pagenum||1},
			function(reviewCnt, list){
				let str = "";
				if(list == null || list.length == 0){
					str += '<li class="noreview" style="clear:both; text-align: center">등록된 리뷰가 없습니다.</li>';
					reviews.html(str);
					return;
				}

				for(let i=0;i<list.length;i++){
					//<li style="clear:both;" class="li3">
					str += '<li style="clear:both;" class="li'+list[i].reviewNum+'">';
					str += '<div style="display:inline; float:left; width:75%;">';
					//<strong class="userid3">apple</strong>
					str += '<strong class="userId'+list[i].reviewNum+'">'+list[i].userId+'</strong>';
					 str += '<span class="userRating" style="margin-left: 10px;">별점: ' + list[i].starRating + '</span>';
					//<p class="review3">댓글내용</p>
					str += '<p class="review'+list[i].reviewNum+'">'+list[i].reviewContent+'</p>';
					str += '</div><div style="text-align:right;">'
					str += '<strong>'+reviewService.displayTime(list[i])+'</strong>'
					str += '<br>'
					if(list[i].userId == loginUser){
						//<a href="3" class="modify">수정</a>

						str += '<a href="'+list[i].reviewNum+'" style="margin-left: 5px;" class="remove btnColor button small">삭제</a>';
					}
					str += '</div></li>';
				}
				reviews.html(str);

				$(".remove").on("click",deleteReview);
				$(".modify").on("click",modifyReview);
				$(".mfinish").on("click",modifyReviewOk);

				showReviewPage(reviewCnt, pagenum);
			}
		)
	}

	function deleteReview(e){
		e.preventDefault();
		let reviewNum = $(this).attr("href");
		reviewService.remove(
			reviewNum,
			function(result){
				if(result == "success"){
					alert(reviewNum+"번 리뷰 삭제 완료!");
					showList(1);
				}
			}
		)
	}
	let reviewFlag = false;
    function modifyReview(e){
        e.preventDefault();
        if(!reviewFlag){
            reviewFlag = true;
            let reviewNum = $(this).attr("href");

            // 해당 리뷰 정보 가져오기
            reviewService.getReview(reviewNum, function(review) {
                const reviewTag = $(".review" + reviewNum);

                // 리뷰 정보로부터 필요한 데이터 가져오기 (예: userId, reviewContent, starRating)
                const userId = review.userId;
                const reviewContent = review.reviewContent;
                const starRating = review.starRating;

                // 수정할 폼 생성 및 초기화
                let form = '<form class="' + reviewNum + ' mdf">';
                form += '<input type="text" class="userId" value="' + userId + '"><br>';
                form += '<textarea class="reviewContent">' + reviewContent + '</textarea><br>';
                form += '<input type="text" class="starRating" value="' + starRating + '"><br>';
                form += '<button class="submitEdit">수정 완료</button></form>';

                reviewTag.html(form);
                $(this).hide();
                $(this).next().show();

                // 수정 완료 버튼 이벤트 처리
                $(".submitEdit").on("click", function(event) {
                    event.preventDefault();

                    // 수정된 데이터 가져오기
                    const editedReview = {
                        "userId": $(".userId").val(),
                        "reviewContent": $(".reviewContent").val(),
                        "starRating": $(".starRating").val(),
                        // 다른 필드들도 필요하다면 추가
                    };

                    // 업데이트 요청 보내기
                    reviewService.update(editedReview, function(result) {
                        alert("수정 완료!");
                        showList(nowpage);
                    });
                });
            });
        } else {
            alert("수정 중인 리뷰가 있습니다!");
        }
    }
	function modifyReviewOk(e){
		e.preventDefault();
		reviewFlag = false;

		let reviewNum = $(this).attr("href");
		let reviewContent = $("."+reviewNum).val();

		if(reviewContent == ""){
			alert("수정할 리뷰 내용을 입력하세요!");
			return;
		}
		reviewService.modify(
			{reviewNum:reviewNum, reviewContent:reviewContent, boardNum:boardNum, userId:loginUser},
			function(result){
				if(result == "success"){
					alert(reviewNum+"번 리뷰 수정 완료!");
					showList(nowpage);
				}
			}
		)
	}


    //좋아요
    $(document).ready(function(){

        //좋아요가 있는지 확인한 값을 heartVal에 저장
        var heartVal = /*[[${heart != null ? heart.heart : ''}]]*/ '';
        console.log("like1"+heartVal);

        //heartVal이 1이면 좋아요가 이미 되어있는것 -> like_on.png 출력
        if(heartVal>0){
            console.log("like2"+heartVal);
            //prop() : 해당 속성을 가져와서 변경
            $(".heart").prop('name',heartVal);
        }
        else{
            console.log("like3"+heartVal);
            $(".heart").prop('name',heartVal);
            }


        //좋아요 버튼 클릭 시 실행되는 코드
        $(".heart").on("click", function(){
            var that = $(this);
            $.ajax({
                url:'/heart/heart',
                type:'POST',
                data: {'boardNum': boardNum, 'userId': loginUser, 'boardCategory':'matching'},
                success: function(data){
                    that.prop('name',data);
                    console.log("data:"+data);
                    if(data==1){
                        $("#heart").prop("src", "/images/like_on.png");
                    }
                    else{
                        $("#heart").prop("src", "/images/like_off.png");
                    }
                    console.log("that:"+that);
                }
            });
        });
    });
    //북마크
        $(document).ready(function(){

		//북마크가 있는지 확인한 값을 bookmarkVal에 저장
		var bookmarkVal = /*[[${bookmark != null ? bookmark.bookmark : ''}]]*/ '';
		console.log(bookmarkVal);

		//bookmarkVal이 1이면 북마크가 이미 되어있는것

		//북마크 버튼 클릭 시 실행되는 코드
		$(".bookmark").on("click", function(){
			var that = $(this);
			that.toggleClass('bookmarked');
			$.ajax({
				url:'/bookmark/bookmark',
				type:'POST',
				data: {'boardNum': boardNum, 'userId': loginUser, 'boardCategory':'matching'},
				success: function(data){
					console.log("data:"+data);
				}
			});
		});
	});


});

    document.addEventListener("DOMContentLoaded", function () {
        const stars = document.querySelectorAll(".rating .star");
        const resultDiv = document.getElementById("result");
        let selectedRating = 0;

        stars.forEach(function (star, index) {
            star.addEventListener("click", function () {
                selectedRating = parseInt(this.getAttribute("data-rating"));
                resultDiv.textContent = `별점: ${selectedRating}`;
                this.parentNode.setAttribute("data-star-rating", selectedRating);
                resetStars();
                highlightStars(index);
            });

            star.addEventListener("mouseover", function () {
                const rating = parseInt(this.getAttribute("data-rating"));
                highlightStars(rating - 1);
            });

            star.addEventListener("mouseout", function () {
                resetStars();
                highlightStars(selectedRating - 1);
            });
        });
    });

    function resetStars() {
        const stars = document.querySelectorAll(".rating .star");
        stars.forEach(function (star) {
            star.classList.remove("active");
        });
    }

    function highlightStars(index) {
        const stars = document.querySelectorAll(".rating .star");
        for (let i = 0; i <= index; i++) {
            stars[i].classList.add("active");
        }
    }


    function modify() {
        const BoardPageForm = document.BoardPageForm;
        console.log(BoardPageForm);

        BoardPageForm.setAttribute("action",/*[[@{/matching/matching_modify}]]*/'');
        BoardPageForm.setAttribute("method", "get");
        BoardPageForm.submit();
    }


    $(".cancel").on("click", function (e) {
        e.preventDefault();
        $(".reviewForm").hide();
        $(".regist").show();
        $("[name='reviewContent']").val("");
    })


	$(".open").on("click", function (e) {
        e.preventDefault();

        var div = document.getElementById('matchingTrainerId');
		var userId = div.innerHTML;

        sendUserIdToModal(userId);
        modalBox.classList.add("active");
    });
</script>
</html>